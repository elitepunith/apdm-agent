import re
from google.adk.tools import FunctionTool

MALWARE_DOMAINS = [
    "malwaredownload.net",
    "virus-bucket.com",
    "trojanlink.io"
]

def check_malware(url: str):
    domain = re.sub(r"https?://", "", url).split("/")[0]

    for bad in MALWARE_DOMAINS:
        if bad in domain:
            return {
                "malware": True,
                "domain": domain,
                "reason": f"Domain '{domain}' is in malware blacklist."
            }

    return {
        "malware": False,
        "domain": domain,
        "reason": "No malware detected."
    }

malware_detector_tool = FunctionTool(func=check_malware)
